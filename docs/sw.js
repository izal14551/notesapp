const CACHE_NAME="story-app-v3",assetsToCache=["./","./index.html","./manifest.json"];self.addEventListener("install",(t=>{t.waitUntil(caches.open(CACHE_NAME).then((t=>(console.log("SW: Pre-caching file inti..."),t.addAll(assetsToCache))))),self.skipWaiting()})),self.addEventListener("activate",(t=>{t.waitUntil(caches.keys().then((t=>Promise.all(t.map((t=>{if(t!==CACHE_NAME)return caches.delete(t)})))))),self.clients.claim()})),self.addEventListener("fetch",(t=>{t.respondWith(fetch(t.request).then((e=>{if(!e||200!==e.status&&"opaque"!==e.type)return e;const s=e.clone();return caches.open(CACHE_NAME).then((e=>{e.put(t.request,s)})),e})).catch((()=>caches.match(t.request).then((e=>e||("navigate"===t.request.mode?caches.match("./index.html"):new Response(null,{status:404,statusText:"Not Found"})))))))})),self.addEventListener("push",(t=>{let e={title:"Story App",options:{body:"Cek cerita baru!"}};if(t.data)try{e=t.data.json()}catch(t){console.error("Push data not JSON:",t)}const s=e.title||"Story App",n={body:e.options&&e.options.body?e.options.body:"Cek cerita baru!",icon:"./icons/icon-192x192.png",data:e.options};t.waitUntil(self.registration.showNotification(s,n))}));